!function(){"use strict";class e{constructor(e,t,n,s,r,o){this.name=e.name,this.link=e.link,this._likes=e.likes,this._id=e._id,this._owner=e.owner,this._currentUserId=o,this.templateSelector=t,this._handleCardClick=n,this._handleCardLike=r,this._handleCardDelete=s}getId(){return this._id}_setMarkup(){this._cardImage=this._cardElement.querySelector(".card__image"),this._cardImage.src=this.link,this._cardImage.alt=this.name,this._cardElement.querySelector(".card__bottom-text").textContent=this.name}_renderLikes(){this._likeCount.textContent=this._likes.length,this.isLikedByUser()?this._likeButton.classList.add("card__bottom-button_clicked"):this._likeButton.classList.remove("card__bottom-button_clicked")}setLikes(e){this._likes=e,this._renderLikes()}_getTemplateClone(){return document.querySelector(this.templateSelector).content.querySelector(".card").cloneNode(!0)}isLikedByUser(){return this._likes.some((e=>e._id===this._currentUserId))}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleCardLike(this)})),this._deleteButton.addEventListener("click",(()=>{this._handleCardDelete(this)})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleCardClick(this)}))}deleteCard(){this._cardElement.remove(),this._cardElement=null}generateCard(){return this._cardElement=this._getTemplateClone(),this._deleteButton=this._cardElement.querySelector(".card__delete"),this._likeCount=this._cardElement.querySelector(".card__bottom-count"),this._likeButton=this._cardElement.querySelector(".card__bottom-button"),this._currentUserId!==this._owner._id&&this._deleteButton.remove(),this._setMarkup(),this._setEventListeners(),this._renderLikes(),this._cardElement}}class t{constructor(e,t){this._settings=e,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._buttonElement=this._formElement.querySelector(this._settings.submitButtonSelector)}enableValidation(){this._setEventListeners()}_setEventListeners(){this._formElement.addEventListener("reset",(()=>{this.resetValidation()})),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._toggleInputError(e),this._toggleButtonState(this._inputList,this._buttonElement)}))}))}_toggleInputError(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_showInputError(e,t){const n=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._settings.inputErrorClass),n.textContent=t,n.classList.add(this._settings.errorClass)}_hideInputError(e){const t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._settings.inputErrorClass),t.classList.remove(this._settings.errorClass),t.textContent=""}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_enableButton(){this._buttonElement.disabled=!1,this._buttonElement.classList.remove(this._settings.inactiveButtonClass)}_disableButton(){this._buttonElement.disabled=!0,this._buttonElement.classList.add(this._settings.inactiveButtonClass)}_toggleButtonState(){this._hasInvalidInput(this._inputList)?this._disableButton():this._enableButton()}resetValidation(){this._disableButton(),this._inputList.forEach((e=>{this._hideInputError(e)}))}}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class s{constructor(e){n(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.closePopup()})),n(this,"_handleClickClose",(e=>{e.target===e.currentTarget&&this.closePopup()})),this._popupElement=e,this._popupExit=this._popupElement.querySelector(".modal__container-exit")}openPopup(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose),this._popupElement.addEventListener("mousedown",this._handleClickClose)}closePopup(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose),this._popupElement.removeEventListener("mousedown",this._handleClickClose)}setEventListeners(){this._popupExit.addEventListener("click",(e=>{this.closePopup()}))}}class r extends s{constructor(e,t){super(e),this._handleFormSubmit=t,this._formElement=this._popupElement.querySelector(".form"),this._inputList=this._formElement.querySelectorAll(".form__input"),this._buttonTextContainer=this._formElement.querySelector(".form__save"),this._defaultButtonText=this._buttonTextContainer.textContent}setLoadingText(e){this._buttonTextContainer.textContent=e?"Saving...":this._defaultButtonText}_getInputValues(){const e={};return this._inputList.forEach((t=>e[t.name]=t.value)),e}setEventListeners(){this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}closePopup(){super.closePopup(),this._formElement.reset()}}class o{constructor(e,t){let{data:n,renderer:s}=e;this._items=n,this._renderer=s,this._container=document.querySelector(t)}renderItems(){this._items.forEach(this._renderer)}addItem(e){this._container.prepend(e)}}document.querySelector(".elements__grid");const i=document.querySelector("#name-input"),a=document.querySelector("#description-input"),l=(document.querySelector(".profile__info-name").textContent,document.querySelector(".profile__info-description").textContent,document.querySelector("#title-input")),c=document.querySelector("#link-input"),d=document.querySelector("#addCard"),u=document.querySelector(".profile__edit"),h=document.querySelector(".profile__add"),_=document.querySelector("#edit"),p=(_.querySelector(".form"),d.querySelector(".form")),m=(document.querySelectorAll(".modal__container-exit"),p.querySelector("button"),document.querySelector("#editAvatar")),E=m.querySelector("#avatar-link-input"),f=(document.querySelector(".profile__image-avatar"),document.querySelector("#editAvatarButton")),v=document.querySelector("#pictureModal"),C=document.querySelector("#deleteCardModal"),g={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__save",inactiveButtonClass:"form__save_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"},S=document.querySelector("#editSubmit"),y=document.querySelector("#addSubmit"),L=document.querySelector("#avatarSubmit");let b=null;const k=new class{constructor(e){let{nameSelector:t,descriptionSelector:n,avatarSelector:s}=e;this._nameContainer=document.querySelector(t),this._descriptionContainer=document.querySelector(n),this._avatarContainer=document.querySelector(s)}getUserInfo(){return{name:this._nameContainer.textContent,about:this._descriptionContainer.textContent}}setUserInfo(e){let{name:t,about:n}=e;this._nameContainer.textContent=t,this._descriptionContainer.textContent=n}getUserAvatar(){return this._avatarContainer.src}setUserAvatar(e){this._avatarContainer.src=e}}({nameSelector:".profile__info-name",descriptionSelector:".profile__info-description",avatarSelector:".profile__image-avatar"}),q=new t(g,S);q.enableValidation();const x=new t(g,y);x.enableValidation();const I=new t(g,L);I.enableValidation();const P=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_handleResponse(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}getInitialCards(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then(this._handleResponse)}getUserData(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then(this._handleResponse)}updateUserInfo(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._handleResponse)}updateProfilePicture(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._handleResponse)}addNewCard(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._handleResponse)}deleteCard(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._handleResponse)}likeCard(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then(this._handleResponse)}unlikeCard(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then(this._handleResponse)}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"dfa974a3-627e-4477-8e0f-f2d5983e285f","Content-Type":"application/json"}});let T;Promise.all([P.getUserData(),P.getInitialCards()]).then((e=>{let[t,n]=e;k.setUserInfo(t),k.setUserAvatar(t.avatar),b=t._id,T=new o({data:n,renderer:U},".elements__grid"),T.renderItems()})).catch((e=>{console.log(e)}));const U=t=>{const n=new e(t,"#card-template",N,(()=>{V.openPopup((()=>{V.setLoadingText(!0),P.deleteCard(n.getId()).then((()=>{n.deleteCard(),V.closePopup()})).catch((e=>{console.log(e)})).finally((()=>{V.setLoadingText(!1)}))}))}),R,b),s=n.generateCard();T.addItem(s)},B=new r(d,(function(){const e={name:l.value,link:c.value};B.setLoadingText(!0),P.addNewCard(e).then((e=>{U(e),B.closePopup()})).catch((e=>{console.log(e)})).finally((()=>{B.setLoadingText(!1)}))}));B.setEventListeners();const w=new r(_,(function(){const e={name:i.value,about:a.value};w.setLoadingText(!0),P.updateUserInfo(e).then((e=>{k.setUserInfo(e),w.closePopup()})).catch((e=>{console.log(e)})).finally((()=>{w.setLoadingText(!1)}))}));w.setEventListeners();const A=new r(m,(function(){const e={avatar:E.value};A.setLoadingText(!0),P.updateProfilePicture(e).then((e=>{k.setUserAvatar(e.avatar),A.closePopup()})).catch((e=>{console.log(e)})).finally((()=>{A.setLoadingText(!1)}))}));A.setEventListeners();const V=new class extends s{constructor(e){super(e),this._formElement=this._popupElement.querySelector(".form"),this._buttonTextContainer=this._formElement.querySelector(".form__save"),this._defaultButtonText=this._buttonTextContainer.textContent}setLoadingText(e){this._buttonTextContainer.textContent=e?"Deleting...":this._defaultButtonText}openPopup(e){this._handleFormSubmit=e,super.openPopup()}setEventListeners(){super.setEventListeners(),this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit()}))}}(C,(function(){P.deleteCard(card.getId()).then((()=>{card.deleteCard()})).catch((e=>{console.log(e)})),V.closePopup()}));V.setEventListeners();const D=new class extends s{constructor(e){super(e),this._popupImage=this._popupElement.querySelector(".modal__picture-image"),this._popupText=this._popupElement.querySelector(".modal__picture-text")}openPopup(e){this._popupImage.src=e.link,this._popupImage.alt=e.name,this._popupText.textContent=e.name,super.openPopup()}}(v);function R(e){e.isLikedByUser()?P.unlikeCard(e.getId()).then((t=>e.setLikes(t.likes))).catch((e=>console.log(e))):P.likeCard(e.getId()).then((t=>e.setLikes(t.likes))).catch((e=>console.log(e)))}function N(e){D.openPopup(e)}D.setEventListeners(),u.addEventListener("click",(function(){const e=k.getUserInfo();i.value=e.name,a.value=e.about,q.resetValidation(),w.openPopup()})),h.addEventListener("click",(function(){x.resetValidation(),B.openPopup()})),f.addEventListener("click",(function(){I.resetValidation(),A.openPopup()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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d0YsTUFBTVAsV0FDUCxHSm1HbUN5QyxHQUd0QyxTQUFTN0gsRUFBZTZLLEdBQ2xCQSxFQUFLcEosZ0JBS1AwSCxFQUFJNkIsV0FBV0gsRUFBSy9KLFNBQ2pCb0osTUFBTXRLLEdBQVNpTCxFQUFLL0ksU0FBU2xDLEVBQUtVLFNBQ2xDaUwsT0FBT0MsR0FBUUMsUUFBUUMsSUFBSUYsS0FOOUJyQyxFQUFJNEIsU0FBU0YsRUFBSy9KLFNBQ2ZvSixNQUFNdEssR0FBU2lMLEVBQUsvSSxTQUFTbEMsRUFBS1UsU0FDbENpTCxPQUFPQyxHQUFRQyxRQUFRQyxJQUFJRixJQU9qQyxDQUVELFNBQVMxTCxFQUFnQitLLEdBQ3ZCd0IsRUFBV2pILFVBQVV5RixFQUN0QixDQWpCRHdCLEVBQVc3RyxvQkE2R1g4QixFQUFXaEYsaUJBQWlCLFNBMUY1QixXQUNFLE1BQU1rSyxFQUFVckUsRUFBS08sY0FDckJ6QixFQUFVYixNQUFRb0csRUFBUXJNLEtBQzFCK0csRUFBaUJkLE1BQVFvRyxFQUFRN0QsTUFDakNLLEVBQWtCekYsa0JBQ2xCMEksRUFBUzdHLFdBQ1YsSUFxRkRtQyxFQUFVakYsaUJBQWlCLFNBbkYzQixXQUNFMkcsRUFBaUIxRixrQkFDakJ3SSxFQUFRM0csV0FDVCxJQWlGRHdDLEVBQWF0RixpQkFBaUIsU0EvRTlCLFdBQ0U0RyxFQUFvQjNGLGtCQUNwQjRJLEVBQVcvRyxXQUNaLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9BcGkuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm0uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gICAgY29uc3RydWN0b3IoZGF0YSwgdGVtcGxhdGVTZWxlY3RvciwgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVDYXJkRGVsZXRlLCBoYW5kbGVDYXJkTGlrZSwgY3VycmVudFVzZXJJZCkge1xyXG4gICAgICB0aGlzLm5hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICAgIHRoaXMubGluayA9IGRhdGEubGluaztcclxuICAgICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xyXG4gICAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xyXG4gICAgICB0aGlzLl9vd25lciA9IGRhdGEub3duZXI7XHJcbiAgICAgIHRoaXMuX2N1cnJlbnRVc2VySWQgPSBjdXJyZW50VXNlcklkO1xyXG4gICAgICB0aGlzLnRlbXBsYXRlU2VsZWN0b3IgPSB0ZW1wbGF0ZVNlbGVjdG9yO1xyXG4gICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRMaWtlID0gaGFuZGxlQ2FyZExpa2U7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmREZWxldGUgPSBoYW5kbGVDYXJkRGVsZXRlO1xyXG5cclxuICAgIH1cclxuICBcclxuICAgIGdldElkKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5faWQ7XHJcbiAgICB9XHJcblxyXG4gICAgX3NldE1hcmt1cCgpIHtcclxuICAgICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMubGluaztcclxuICAgICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMubmFtZTtcclxuICAgICAgY29uc3QgY2FyZFRleHQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2JvdHRvbS10ZXh0XCIpO1xyXG4gICAgICBjYXJkVGV4dC50ZXh0Q29udGVudCA9IHRoaXMubmFtZTtcclxuICAgIH1cclxuICBcclxuICAgIF9yZW5kZXJMaWtlcygpIHtcclxuICAgICAgdGhpcy5fbGlrZUNvdW50LnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gICAgICBpZiAodGhpcy5pc0xpa2VkQnlVc2VyKCkpIHtcclxuICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19ib3R0b20tYnV0dG9uX2NsaWNrZWRcIik7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fYm90dG9tLWJ1dHRvbl9jbGlja2VkXCIpO1xyXG4gICAgICB9XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgc2V0TGlrZXMobGlrZXMpIHtcclxuICAgICAgdGhpcy5fbGlrZXMgPSBsaWtlcztcclxuICAgICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0VGVtcGxhdGVDbG9uZSgpIHtcclxuICAgICAgY29uc3QgY2xvbmVFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLnRlbXBsYXRlU2VsZWN0b3IpXHJcbiAgICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgcmV0dXJuIGNsb25lRWxlbWVudDtcclxuICAgIH1cclxuICBcclxuICAgIGlzTGlrZWRCeVVzZXIoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKChsaWtlKSA9PiBsaWtlLl9pZCA9PT0gdGhpcy5fY3VycmVudFVzZXJJZCk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgIHRoaXMuX2xpa2VCdXR0b25cclxuICAgICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgIHRoaXMuX2hhbmRsZUNhcmRMaWtlKHRoaXMpO1xyXG4gICAgICAgIH0pO1xyXG4gIFxyXG4gICAgICB0aGlzLl9kZWxldGVCdXR0b25cclxuICAgICAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVDYXJkRGVsZXRlKHRoaXMpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIFxyXG5cclxuICAgICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKVxyXG4gICAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZUNhcmQoKSB7XHJcbiAgICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGVDbG9uZSgpO1xyXG4gICAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZVwiKTtcclxuICAgICAgdGhpcy5fbGlrZUNvdW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19ib3R0b20tY291bnRcIik7XHJcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2JvdHRvbS1idXR0b25cIik7XHJcbiAgICAgIGlmICh0aGlzLl9jdXJyZW50VXNlcklkICE9PSB0aGlzLl9vd25lci5faWQpIHtcclxuICAgICAgICB0aGlzLl9kZWxldGVCdXR0b24ucmVtb3ZlKCk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5fc2V0TWFya3VwKCk7XHJcbiAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XHJcbiAgICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICAgIH1cclxuICB9XHJcbiAgIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgICAgdGhpcy5fc2V0dGluZ3MgPSBzZXR0aW5ncztcclxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3NldHRpbmdzLmlucHV0U2VsZWN0b3IpXHJcbiAgICAgICk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICAgIHRoaXMuX3NldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwicmVzZXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLl90b2dnbGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9pbnB1dExpc3QsIHRoaXMuX2J1dHRvbkVsZW1lbnQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICBcclxuICAgIF90b2dnbGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgXHJcbiAgICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcclxuICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICAgKTtcclxuICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcclxuICAgIH1cclxuICBcclxuICAgIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICAgKTtcclxuICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XHJcbiAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBfZW5hYmxlQnV0dG9uKCkge1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB9XHJcblxyXG4gICAgX2Rpc2FibGVCdXR0b24oKSB7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0TGlzdCkpIHtcclxuICAgICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICBcclxuICAgIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwRWxlbWVudCkge1xyXG4gICAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBwb3B1cEVsZW1lbnQ7XHJcbiAgICAgIHRoaXMuX3BvcHVwRXhpdCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICAgIFwiLm1vZGFsX19jb250YWluZXItZXhpdFwiXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBvcGVuUG9wdXAoKSB7XHJcbiAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZUNsaWNrQ2xvc2UpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgY2xvc2VQb3B1cCgpIHtcclxuICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlQ2xpY2tDbG9zZSk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZVBvcHVwKCk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgXHJcbiAgICBfaGFuZGxlQ2xpY2tDbG9zZSA9IChldnQpID0+IHtcclxuICAgICAgaWYgKGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZVBvcHVwKCk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgdGhpcy5fcG9wdXBFeGl0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgdGhpcy5jbG9zZVBvcHVwKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBFbGVtZW50LCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cEVsZW1lbnQpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmZvcm1fX2lucHV0XCIpO1xyXG4gICAgdGhpcy5fYnV0dG9uVGV4dENvbnRhaW5lciA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fc2F2ZVwiKTtcclxuICAgIHRoaXMuX2RlZmF1bHRCdXR0b25UZXh0ID0gdGhpcy5fYnV0dG9uVGV4dENvbnRhaW5lci50ZXh0Q29udGVudDtcclxuICB9XHJcblxyXG4gIHNldExvYWRpbmdUZXh0KGlzTG9hZGluZykge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICAgIHRoaXMuX2J1dHRvblRleHRDb250YWluZXIudGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiOyBcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uVGV4dENvbnRhaW5lci50ZXh0Q29udGVudCA9IHRoaXMuX2RlZmF1bHRCdXR0b25UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBmb3JtVmFsdWVzID0ge307XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IChmb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWUpKTtcclxuXHJcbiAgICByZXR1cm4gZm9ybVZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIGNsb3NlUG9wdXAoKSB7XHJcbiAgICBzdXBlci5jbG9zZVBvcHVwKCk7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xyXG4gIH1cclxuICBcclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gICAgY29uc3RydWN0b3IoeyBkYXRhLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgICB0aGlzLl9pdGVtcyA9IGRhdGE7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICAgIHRoaXMuX2l0ZW1zLmZvckVhY2godGhpcy5fcmVuZGVyZXIpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH0iLCJjb25zdCBjYXJkVGVtcGxhdGUgPSBcIiNjYXJkLXRlbXBsYXRlXCI7XHJcbmNvbnN0IGVsZW1lbnRzR3JpZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2dyaWRcIik7XHJcbmNvbnN0IGdyaWRTZWxlY3RvciA9IFwiLmVsZW1lbnRzX19ncmlkXCI7XHJcbmNvbnN0IG5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmFtZS1pbnB1dFwiKTtcclxuY29uc3QgZGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVzY3JpcHRpb24taW5wdXRcIik7XHJcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbmZvLW5hbWVcIikudGV4dENvbnRlbnQ7XHJcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW5mby1kZXNjcmlwdGlvblwiKS50ZXh0Q29udGVudDtcclxuY29uc3QgdGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdGl0bGUtaW5wdXRcIik7XHJcbmNvbnN0IGxpbmtJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbGluay1pbnB1dFwiKTtcclxuY29uc3QgYWRkQ2FyZFdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkQ2FyZFwiKTtcclxuY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdFwiKTtcclxuY29uc3QgYWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGRcIik7XHJcbmNvbnN0IGVkaXRXaW5kb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXRcIik7XHJcbmNvbnN0IGVkaXRGb3JtRWxlbWVudCA9IGVkaXRXaW5kb3cucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xyXG5jb25zdCBhZGRGb3JtRWxlbWVudCA9IGFkZENhcmRXaW5kb3cucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xyXG5jb25zdCBleGl0QnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2NvbnRhaW5lci1leGl0XCIpO1xyXG5jb25zdCBzYXZlQnV0dG9uQWRkID0gYWRkRm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcImJ1dHRvblwiKTtcclxuY29uc3QgYXZhdGFyV2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0QXZhdGFyXCIpO1xyXG5jb25zdCBhdmF0YXJJbnB1dCA9IGF2YXRhcldpbmRvdy5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1saW5rLWlucHV0XCIpO1xyXG5jb25zdCBhdmF0YXJQaWN0dXJlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZS1hdmF0YXJcIik7XHJcbmNvbnN0IGF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdEF2YXRhckJ1dHRvblwiKTtcclxuY29uc3QgcGljdHVyZVdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGljdHVyZU1vZGFsXCIpO1xyXG5jb25zdCBkZWxldGVXaW5kb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZUNhcmRNb2RhbFwiKTtcclxuY29uc3QgdXNlclNlbGVjdG9yID0ge25hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9faW5mby1uYW1lXCIsIGRlc2NyaXB0aW9uU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2luZm8tZGVzY3JpcHRpb25cIiwgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlLWF2YXRhclwifTtcclxuXHJcbmNvbnN0IHNldHRpbmdzID0ge1xyXG4gICAgZm9ybVNlbGVjdG9yOiBcIi5mb3JtXCIsIFxyXG4gICAgaW5wdXRTZWxlY3RvcjogXCIuZm9ybV9faW5wdXRcIiwgXHJcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIuZm9ybV9fc2F2ZVwiLCBcclxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9fc2F2ZV9kaXNhYmxlZFwiLCBcclxuICAgIGlucHV0RXJyb3JDbGFzczogXCJmb3JtX19pbnB1dF90eXBlX2Vycm9yXCIsIFxyXG4gICAgZXJyb3JDbGFzczogXCJmb3JtX19pbnB1dC1lcnJvcl9hY3RpdmVcIlxyXG59XHJcblxyXG5jb25zdCBlZGl0Rm9ybVNlbGVjdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0U3VibWl0XCIpO1xyXG5jb25zdCBhZGRGb3JtU2VsZWN0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZFN1Ym1pdFwiKTtcclxuY29uc3QgYXZhdGFyRm9ybVNlbGVjdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXJTdWJtaXRcIik7XHJcblxyXG5leHBvcnQge2NhcmRUZW1wbGF0ZSwgXHJcbiAgICBlbGVtZW50c0dyaWQsXHJcbiAgICBncmlkU2VsZWN0b3IsIFxyXG4gICAgbmFtZUlucHV0LCBcclxuICAgIGRlc2NyaXB0aW9uSW5wdXQsIFxyXG4gICAgcHJvZmlsZU5hbWUsIFxyXG4gICAgcHJvZmlsZURlc2NyaXB0aW9uLCBcclxuICAgIHRpdGxlSW5wdXQsIFxyXG4gICAgbGlua0lucHV0LCBcclxuICAgIGFkZENhcmRXaW5kb3csIFxyXG4gICAgZWRpdEJ1dHRvbiwgXHJcbiAgICBhZGRCdXR0b24sIFxyXG4gICAgZWRpdFdpbmRvdywgXHJcbiAgICBlZGl0Rm9ybUVsZW1lbnQsIFxyXG4gICAgYWRkRm9ybUVsZW1lbnQsIFxyXG4gICAgZXhpdEJ1dHRvbnMsIFxyXG4gICAgc2F2ZUJ1dHRvbkFkZCxcclxuICAgIGF2YXRhcldpbmRvdyxcclxuICAgIGF2YXRhcklucHV0LFxyXG4gICAgYXZhdGFyUGljdHVyZSxcclxuICAgIGF2YXRhckJ1dHRvbixcclxuICAgIHBpY3R1cmVXaW5kb3csXHJcbiAgICBkZWxldGVXaW5kb3csXHJcbiAgICB1c2VyU2VsZWN0b3IsICAgXHJcbiAgICBzZXR0aW5ncywgXHJcbiAgICBlZGl0Rm9ybVNlbGVjdG9yLCBcclxuICAgIGFkZEZvcm1TZWxlY3RvciwgXHJcbiAgICBhdmF0YXJGb3JtU2VsZWN0b3JcclxufTsiLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcclxuaW1wb3J0IHtcclxuICBjYXJkVGVtcGxhdGUsXHJcbiAgZ3JpZFNlbGVjdG9yLFxyXG4gIG5hbWVJbnB1dCxcclxuICBkZXNjcmlwdGlvbklucHV0LFxyXG4gIHRpdGxlSW5wdXQsXHJcbiAgbGlua0lucHV0LFxyXG4gIGFkZENhcmRXaW5kb3csXHJcbiAgZWRpdEJ1dHRvbixcclxuICBhZGRCdXR0b24sXHJcbiAgZWRpdFdpbmRvdyxcclxuICBwaWN0dXJlV2luZG93LFxyXG4gIHVzZXJTZWxlY3RvcixcclxuICBzZXR0aW5ncyxcclxuICBhdmF0YXJJbnB1dCxcclxuICBhdmF0YXJQaWN0dXJlLFxyXG4gIGF2YXRhcldpbmRvdyxcclxuICBhdmF0YXJCdXR0b24sICBcclxuICBkZWxldGVXaW5kb3csIFxyXG4gIGVkaXRGb3JtU2VsZWN0b3IsIFxyXG4gIGFkZEZvcm1TZWxlY3RvciwgXHJcbiAgYXZhdGFyRm9ybVNlbGVjdG9yXHJcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5cclxubGV0IGN1cnJlbnRVc2VySWQgPSBudWxsO1xyXG5cclxuY29uc3QgdXNlciA9IG5ldyBVc2VySW5mbyh1c2VyU2VsZWN0b3IpO1xyXG5cclxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgZWRpdEZvcm1TZWxlY3Rvcik7XHJcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgYWRkRm9ybVNlbGVjdG9yKTtcclxuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGF2YXRhckZvcm1TZWxlY3Rvcik7XHJcbmF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSAoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMlwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiZGZhOTc0YTMtNjI3ZS00NDc3LThlMGYtZjJkNTk4M2UyODVmXCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gIH1cclxufSk7XHJcblxyXG5sZXQgY2FyZFNlY3Rpb247XHJcblxyXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJEYXRhKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXHJcbiAgLnRoZW4oKFt1c2VySW5mb1JlcywgY2FyZFJlc10pID0+IHtcclxuICAgIHVzZXIuc2V0VXNlckluZm8odXNlckluZm9SZXMpO1xyXG4gICAgdXNlci5zZXRVc2VyQXZhdGFyKHVzZXJJbmZvUmVzLmF2YXRhcik7XHJcbiAgICBjdXJyZW50VXNlcklkID0gdXNlckluZm9SZXMuX2lkO1xyXG5cclxuICAgIGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAgICAgIHtcclxuICAgICAgICBkYXRhOiBjYXJkUmVzLFxyXG4gICAgICAgIHJlbmRlcmVyOiByZW5kZXJDYXJkLFxyXG4gICAgICB9LFxyXG4gICAgICBncmlkU2VsZWN0b3JcclxuICAgICk7XHJcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgfSk7XHJcblxyXG5jb25zdCByZW5kZXJDYXJkID0gKGNhcmRJdGVtKSA9PiB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgY2FyZEl0ZW0sIFxyXG4gICAgY2FyZFRlbXBsYXRlLCBcclxuICAgIGhhbmRsZUNhcmRDbGljaywgXHJcbiAgICAoKSA9PiB7XHJcbiAgICAgIGRlbGV0ZUZvcm0ub3BlblBvcHVwKCgpID0+IHtcclxuICAgICAgICBkZWxldGVGb3JtLnNldExvYWRpbmdUZXh0KHRydWUpO1xyXG4gICAgICAgIGFwaS5kZWxldGVDYXJkKGNhcmQuZ2V0SWQoKSlcclxuICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgY2FyZC5kZWxldGVDYXJkKCk7XHJcbiAgICAgICAgICAgIGRlbGV0ZUZvcm0uY2xvc2VQb3B1cCgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICBkZWxldGVGb3JtLnNldExvYWRpbmdUZXh0KGZhbHNlKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0sIFxyXG4gICAgaGFuZGxlQ2FyZExpa2UsIFxyXG4gICAgY3VycmVudFVzZXJJZCk7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xyXG5cclxuICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxufTtcclxuXHJcbmNvbnN0IGFkZEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShhZGRDYXJkV2luZG93LCBoYW5kbGVBZGRGb3JtU3VibWl0KTtcclxuYWRkRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgZWRpdEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShlZGl0V2luZG93LCBoYW5kbGVFZGl0Rm9ybVN1Ym1pdCk7XHJcbmVkaXRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBhdmF0YXJGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oYXZhdGFyV2luZG93LCBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KTtcclxuYXZhdGFyRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgZGVsZXRlRm9ybSA9IG5ldyBQb3B1cFdpdGhDb25maXJtKGRlbGV0ZVdpbmRvdywgaGFuZGxlRGVsZXRlRm9ybVN1Ym1pdCk7XHJcbmRlbGV0ZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UocGljdHVyZVdpbmRvdyk7XHJcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRMaWtlKGNhcmQpIHtcclxuICBpZighY2FyZC5pc0xpa2VkQnlVc2VyKCkpIHtcclxuICAgIGFwaS5saWtlQ2FyZChjYXJkLmdldElkKCkpXHJcbiAgICAgIC50aGVuKChkYXRhKSA9PiBjYXJkLnNldExpa2VzKGRhdGEubGlrZXMpKVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGFwaS51bmxpa2VDYXJkKGNhcmQuZ2V0SWQoKSlcclxuICAgICAgLnRoZW4oKGRhdGEpID0+IGNhcmQuc2V0TGlrZXMoZGF0YS5saWtlcykpXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICB9XHJcblxyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVDYXJkQ2xpY2soY2FyZCkge1xyXG4gIGltYWdlUG9wdXAub3BlblBvcHVwKGNhcmQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVNb2RhbEVkaXQoKSB7XHJcbiAgY29uc3QgbmV3VXNlciA9IHVzZXIuZ2V0VXNlckluZm8oKTtcclxuICBuYW1lSW5wdXQudmFsdWUgPSBuZXdVc2VyLm5hbWU7XHJcbiAgZGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IG5ld1VzZXIuYWJvdXQ7XHJcbiAgZWRpdEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgZWRpdEZvcm0ub3BlblBvcHVwKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZU1vZGFsQWRkKCkge1xyXG4gIGFkZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgYWRkRm9ybS5vcGVuUG9wdXAoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTW9kYWxBdmF0YXIoKSB7XHJcbiAgYXZhdGFyRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICBhdmF0YXJGb3JtLm9wZW5Qb3B1cCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFZGl0Rm9ybVN1Ym1pdCgpIHtcclxuICBjb25zdCBuZXdOYW1lID0gbmFtZUlucHV0LnZhbHVlO1xyXG4gIGNvbnN0IG5ld0Rlc2NyaXB0aW9uID0gZGVzY3JpcHRpb25JbnB1dC52YWx1ZTtcclxuICBjb25zdCBuZXdVc2VySW5mbyA9IHsgbmFtZTogbmV3TmFtZSwgYWJvdXQ6IG5ld0Rlc2NyaXB0aW9uIH07XHJcbiAgZWRpdEZvcm0uc2V0TG9hZGluZ1RleHQodHJ1ZSk7XHJcbiAgYXBpLnVwZGF0ZVVzZXJJbmZvKG5ld1VzZXJJbmZvKVxyXG4gICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgdXNlci5zZXRVc2VySW5mbyhyZXMpO1xyXG4gICAgICBlZGl0Rm9ybS5jbG9zZVBvcHVwKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBlZGl0Rm9ybS5zZXRMb2FkaW5nVGV4dChmYWxzZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUFkZEZvcm1TdWJtaXQoKSB7XHJcbiAgY29uc3QgY2FyZERhdGEgPSB7XHJcbiAgICBuYW1lOiB0aXRsZUlucHV0LnZhbHVlLFxyXG4gICAgbGluazogbGlua0lucHV0LnZhbHVlLFxyXG4gIH07XHJcbiAgYWRkRm9ybS5zZXRMb2FkaW5nVGV4dCh0cnVlKTtcclxuICBhcGkuYWRkTmV3Q2FyZChjYXJkRGF0YSlcclxuICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgIHJlbmRlckNhcmQocmVzKTtcclxuICAgICAgYWRkRm9ybS5jbG9zZVBvcHVwKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBhZGRGb3JtLnNldExvYWRpbmdUZXh0KGZhbHNlKTtcclxuICAgIH0pO1xyXG4gIFxyXG4gIFxyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KCkge1xyXG4gIGNvbnN0IGF2YXRhckluZm8gPSB7YXZhdGFyOiBhdmF0YXJJbnB1dC52YWx1ZX07XHJcbiAgXHJcbiAgYXZhdGFyRm9ybS5zZXRMb2FkaW5nVGV4dCh0cnVlKTtcclxuICBhcGkudXBkYXRlUHJvZmlsZVBpY3R1cmUoYXZhdGFySW5mbylcclxuICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgIHVzZXIuc2V0VXNlckF2YXRhcihyZXMuYXZhdGFyKTtcclxuICAgICAgYXZhdGFyRm9ybS5jbG9zZVBvcHVwKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBhdmF0YXJGb3JtLnNldExvYWRpbmdUZXh0KGZhbHNlKTtcclxuICAgIH0pO1xyXG5cclxuICBcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlRm9ybVN1Ym1pdCgpIHtcclxuICBhcGkuZGVsZXRlQ2FyZChjYXJkLmdldElkKCkpXHJcbiAgLnRoZW4oKCkgPT4ge1xyXG4gICAgY2FyZC5kZWxldGVDYXJkKCk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTtcclxuICB9KVxyXG5cclxuICBkZWxldGVGb3JtLmNsb3NlUG9wdXAoKTtcclxufVxyXG5cclxuZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlTW9kYWxFZGl0KTtcclxuYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVNb2RhbEFkZCk7XHJcbmF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlTW9kYWxBdmF0YXIpO1xyXG5cclxuXHJcblxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3RvciwgZGVzY3JpcHRpb25TZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xyXG4gICAgICB0aGlzLl9uYW1lQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgICB0aGlzLl9kZXNjcmlwdGlvbkNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGVzY3JpcHRpb25TZWxlY3Rvcik7XHJcbiAgICAgIHRoaXMuX2F2YXRhckNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgbmFtZTogdGhpcy5fbmFtZUNvbnRhaW5lci50ZXh0Q29udGVudCxcclxuICAgICAgICBhYm91dDogdGhpcy5fZGVzY3JpcHRpb25Db250YWluZXIudGV4dENvbnRlbnRcclxuICAgICAgfTtcclxuICAgIH1cclxuICBcclxuICAgIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgICB0aGlzLl9uYW1lQ29udGFpbmVyLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgICAgdGhpcy5fZGVzY3JpcHRpb25Db250YWluZXIudGV4dENvbnRlbnQgPSBhYm91dDtcclxuICAgIH1cclxuXHJcbiAgICBnZXRVc2VyQXZhdGFyKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fYXZhdGFyQ29udGFpbmVyLnNyYztcclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VyQXZhdGFyKGF2YXRhcikge1xyXG4gICAgICB0aGlzLl9hdmF0YXJDb250YWluZXIuc3JjID0gYXZhdGFyO1xyXG4gICAgfVxyXG4gIH0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gICAgY29uc3RydWN0b3Iob3B0aW9ucykge1xyXG4gICAgICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICAgICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcclxuICAgIH1cclxuXHJcbiAgICBfaGFuZGxlUmVzcG9uc2UocmVzKSB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7aGVhZGVyczogdGhpcy5faGVhZGVyc30pXHJcbiAgICAgICAgICAgIC50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICAgIH0gXHJcblxyXG4gICAgZ2V0VXNlckRhdGEoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge2hlYWRlcnM6IHRoaXMuX2hlYWRlcnN9KVxyXG4gICAgICAgIC50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVVc2VySW5mbyh1c2VyT2JqKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKFxyXG4gICAgICAgICAgICBgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLCBcclxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsIFxyXG4gICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkodXNlck9iailcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIClcclxuICAgICAgICAudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlUHJvZmlsZVBpY3R1cmUoaW5mbykge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChcclxuICAgICAgICAgICAgYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsIFxyXG4gICAgICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycywgXHJcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShpbmZvKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKVxyXG4gICAgICAgIC50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgYWRkTmV3Q2FyZChjYXJkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKFxyXG4gICAgICAgICAgICBgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsIFxyXG4gICAgICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBjYXJkLm5hbWUsIFxyXG4gICAgICAgICAgICAgICAgICAgIGxpbms6IGNhcmQubGlua1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIClcclxuICAgICAgICAudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goXHJcbiAgICAgICAgICAgIGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIiwgXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApXHJcbiAgICAgICAgLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIGxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChcclxuICAgICAgICAgICAgYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBVVFwiLCBcclxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIClcclxuICAgICAgICAudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgdW5saWtlQ2FyZChjYXJkSWQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goXHJcbiAgICAgICAgICAgIGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIiwgXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApXHJcbiAgICAgICAgLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBFbGVtZW50KSB7XHJcbiAgICAgICAgc3VwZXIocG9wdXBFbGVtZW50KTtcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uVGV4dENvbnRhaW5lciA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fc2F2ZVwiKTtcclxuICAgICAgICB0aGlzLl9kZWZhdWx0QnV0dG9uVGV4dCA9IHRoaXMuX2J1dHRvblRleHRDb250YWluZXIudGV4dENvbnRlbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0TG9hZGluZ1RleHQoaXNMb2FkaW5nKSB7XHJcbiAgICAgICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICAgICAgICB0aGlzLl9idXR0b25UZXh0Q29udGFpbmVyLnRleHRDb250ZW50ID0gXCJEZWxldGluZy4uLlwiOyBcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9idXR0b25UZXh0Q29udGFpbmVyLnRleHRDb250ZW50ID0gdGhpcy5fZGVmYXVsdEJ1dHRvblRleHQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9wZW5Qb3B1cChoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICAgICAgc3VwZXIub3BlblBvcHVwKCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KCk7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBFbGVtZW50KSB7XHJcbiAgICBzdXBlcihwb3B1cEVsZW1lbnQpO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5tb2RhbF9fcGljdHVyZS1pbWFnZVwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5fcG9wdXBUZXh0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3BpY3R1cmUtdGV4dFwiKTtcclxuICB9XHJcblxyXG4gIG9wZW5Qb3B1cChjYXJkKSB7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLnNyYyA9IGNhcmQubGluaztcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2UuYWx0ID0gY2FyZC5uYW1lO1xyXG4gICAgdGhpcy5fcG9wdXBUZXh0LnRleHRDb250ZW50ID0gY2FyZC5uYW1lO1xyXG4gICAgc3VwZXIub3BlblBvcHVwKCk7XHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJ0ZW1wbGF0ZVNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlQ2FyZERlbGV0ZSIsImhhbmRsZUNhcmRMaWtlIiwiY3VycmVudFVzZXJJZCIsInRoaXMiLCJuYW1lIiwibGluayIsIl9saWtlcyIsImxpa2VzIiwiX2lkIiwiX293bmVyIiwib3duZXIiLCJfY3VycmVudFVzZXJJZCIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlQ2FyZExpa2UiLCJfaGFuZGxlQ2FyZERlbGV0ZSIsImdldElkIiwiX3NldE1hcmt1cCIsIl9jYXJkSW1hZ2UiLCJfY2FyZEVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJfcmVuZGVyTGlrZXMiLCJfbGlrZUNvdW50IiwibGVuZ3RoIiwiaXNMaWtlZEJ5VXNlciIsIl9saWtlQnV0dG9uIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwic2V0TGlrZXMiLCJfZ2V0VGVtcGxhdGVDbG9uZSIsImRvY3VtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsInNvbWUiLCJsaWtlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9kZWxldGVCdXR0b24iLCJkZWxldGVDYXJkIiwiZ2VuZXJhdGVDYXJkIiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfc2V0dGluZ3MiLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJfYnV0dG9uRWxlbWVudCIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiZW5hYmxlVmFsaWRhdGlvbiIsInJlc2V0VmFsaWRhdGlvbiIsImZvckVhY2giLCJpbnB1dEVsZW1lbnQiLCJfdG9nZ2xlSW5wdXRFcnJvciIsIl90b2dnbGVCdXR0b25TdGF0ZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsImlkIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfZW5hYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2Rpc2FibGVCdXR0b24iLCJQb3B1cCIsInBvcHVwRWxlbWVudCIsImV2dCIsImtleSIsImNsb3NlUG9wdXAiLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwiX3BvcHVwRWxlbWVudCIsIl9wb3B1cEV4aXQiLCJvcGVuUG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJfaGFuZGxlQ2xpY2tDbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9idXR0b25UZXh0Q29udGFpbmVyIiwiX2RlZmF1bHRCdXR0b25UZXh0Iiwic2V0TG9hZGluZ1RleHQiLCJpc0xvYWRpbmciLCJfZ2V0SW5wdXRWYWx1ZXMiLCJmb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInByZXZlbnREZWZhdWx0IiwicmVzZXQiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsIm5hbWVJbnB1dCIsImRlc2NyaXB0aW9uSW5wdXQiLCJ0aXRsZUlucHV0IiwibGlua0lucHV0IiwiYWRkQ2FyZFdpbmRvdyIsImVkaXRCdXR0b24iLCJhZGRCdXR0b24iLCJlZGl0V2luZG93IiwiYWRkRm9ybUVsZW1lbnQiLCJhdmF0YXJXaW5kb3ciLCJhdmF0YXJJbnB1dCIsImF2YXRhckJ1dHRvbiIsInBpY3R1cmVXaW5kb3ciLCJkZWxldGVXaW5kb3ciLCJmb3JtU2VsZWN0b3IiLCJlZGl0Rm9ybVNlbGVjdG9yIiwiYWRkRm9ybVNlbGVjdG9yIiwiYXZhdGFyRm9ybVNlbGVjdG9yIiwidXNlciIsIm5hbWVTZWxlY3RvciIsImRlc2NyaXB0aW9uU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lQ29udGFpbmVyIiwiX2Rlc2NyaXB0aW9uQ29udGFpbmVyIiwiX2F2YXRhckNvbnRhaW5lciIsImdldFVzZXJJbmZvIiwiYWJvdXQiLCJzZXRVc2VySW5mbyIsImdldFVzZXJBdmF0YXIiLCJzZXRVc2VyQXZhdGFyIiwiYXZhdGFyIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJhZGRGb3JtVmFsaWRhdG9yIiwiYXZhdGFyRm9ybVZhbGlkYXRvciIsImFwaSIsIm9wdGlvbnMiLCJfYmFzZVVybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJfaGFuZGxlUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwiZ2V0VXNlckRhdGEiLCJ1cGRhdGVVc2VySW5mbyIsInVzZXJPYmoiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInVwZGF0ZVByb2ZpbGVQaWN0dXJlIiwiaW5mbyIsImFkZE5ld0NhcmQiLCJjYXJkIiwiY2FyZElkIiwibGlrZUNhcmQiLCJ1bmxpa2VDYXJkIiwiYXV0aG9yaXphdGlvbiIsImNhcmRTZWN0aW9uIiwiYWxsIiwidXNlckluZm9SZXMiLCJjYXJkUmVzIiwicmVuZGVyQ2FyZCIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImNhcmRJdGVtIiwiZGVsZXRlRm9ybSIsImZpbmFsbHkiLCJjYXJkRWxlbWVudCIsImFkZEZvcm0iLCJjYXJkRGF0YSIsImVkaXRGb3JtIiwibmV3VXNlckluZm8iLCJhdmF0YXJGb3JtIiwiYXZhdGFySW5mbyIsImltYWdlUG9wdXAiLCJfcG9wdXBJbWFnZSIsIl9wb3B1cFRleHQiLCJuZXdVc2VyIl0sInNvdXJjZVJvb3QiOiIifQ==