!function(){"use strict";class e{constructor(e,t,s,n,r,o){this.name=e.name,this.link=e.link,this._likes=e.likes,this._id=e._id,this._owner=e.owner,this._currentUserId=o,this.templateSelector=t,this._handleCardClick=s,this._handleCardLike=r,this._handleCardDelete=n}getId(){return this._id}_setMarkup(){this._cardImage=this._cardElement.querySelector(".card__image"),this._cardImage.src=this.link,this._cardImage.alt=this.name,this._cardElement.querySelector(".card__bottom-text").textContent=this.name}_renderLikes(){this._cardElement.querySelector(".card__bottom-count").textContent=this._likes.length,this.likeButton=this._cardElement.querySelector(".card__bottom-button"),this.isLikedByUser()?this.likeButton.classList.add("card__bottom-button_clicked"):this.likeButton.classList.remove("card__bottom-button_clicked")}setLikes(e){this._likes=e,this._renderLikes()}_getTemplateClone(){return document.querySelector(this.templateSelector).content.querySelector(".card").cloneNode(!0)}isLikedByUser(){return this._likes.some((e=>e._id===this._currentUserId))}_setEventListeners(){this._cardElement.querySelector(".card__bottom-button").addEventListener("click",(()=>{this._handleCardLike(this)})),this._deleteButton.addEventListener("click",(()=>{this._handleCardDelete(this)})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleCardClick(this)}))}deleteCard(){this._cardElement.remove(),this._cardElement=null}generateCard(){return this._cardElement=this._getTemplateClone(),this._deleteButton=this._cardElement.querySelector(".card__delete"),this._currentUserId!==this._owner._id&&this._deleteButton.remove(),this._setMarkup(),this._setEventListeners(),this._renderLikes(),this._cardElement}}class t{constructor(e,t){this._settings=e,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._buttonElement=this._formElement.querySelector(this._settings.submitButtonSelector)}enableValidation(){this._setEventListeners()}_setEventListeners(){this._toggleButtonState(),this._formElement.addEventListener("reset",(()=>{this._resetValidation()})),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._toggleInputError(e),this._toggleButtonState(this._inputList,this._buttonElement)}))}))}_toggleInputError(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_showInputError(e,t){const s=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._settings.inputErrorClass),s.textContent=t,s.classList.add(this._settings.errorClass)}_hideInputError(e){const t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._settings.inputErrorClass),t.classList.remove(this._settings.errorClass),t.textContent=""}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_enableButton(){this._buttonElement.disabled=!1,this._buttonElement.classList.remove(this._settings.inactiveButtonClass)}_disableButton(){this._buttonElement.disabled=!0,this._buttonElement.classList.add(this._settings.inactiveButtonClass)}_toggleButtonState(){this._hasInvalidInput(this._inputList)?this._disableButton():this._enableButton()}_resetValidation(){this._disableButton(),this._inputList.forEach((e=>{this._hideInputError(e)}))}}function s(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class n{constructor(e){s(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.closePopup()})),s(this,"_handleClickClose",(e=>{e.target===e.currentTarget&&this.closePopup()})),this._popupElement=e,this._popupExit=this._popupElement.querySelector(".modal__container-exit")}openPopup(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose),this._popupElement.addEventListener("mousedown",this._handleClickClose)}closePopup(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose),this._popupElement.removeEventListener("mousedown",this._handleClickClose)}setEventListeners(){this._popupExit.addEventListener("click",(e=>{this.closePopup()}))}}class r extends n{constructor(e,t){super(e),this._handleFormSubmit=t,this._formElement=this._popupElement.querySelector(".form"),this._inputList=this._formElement.querySelectorAll(".form__input"),this._buttonTextContainer=this._formElement.querySelector(".form__save"),this._defaultButtonText=this._buttonTextContainer.textContent}setLoadingText(e){this._buttonTextContainer.textContent=e?"Saving...":this._defaultButtonText}_getInputValues(){const e={};return this._inputList.forEach((t=>e[t.name]=t.value)),e}setEventListeners(){this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}closePopup(){super.closePopup(),this._formElement.reset()}}class o{constructor(e,t){let{data:s,renderer:n}=e;this._items=s,this._renderer=n,this._container=document.querySelector(t)}renderItems(){this._items.forEach(this._renderer)}addItem(e){this._container.prepend(e)}}document.querySelector(".elements__grid");const i=document.querySelector("#name-input"),a=document.querySelector("#description-input"),l=(document.querySelector(".profile__info-name").textContent,document.querySelector(".profile__info-description").textContent,document.querySelector("#title-input")),c=document.querySelector("#link-input"),d=document.querySelector("#addCard"),u=document.querySelector(".profile__edit"),h=document.querySelector(".profile__add"),_=document.querySelector("#edit"),p=(_.querySelector(".form"),d.querySelector(".form")),m=(document.querySelectorAll(".modal__container-exit"),p.querySelector("button"),document.querySelector("#editAvatar")),E=m.querySelector("#avatar-link-input"),f=document.querySelector(".profile__image-avatar"),v=document.querySelector("#editAvatarButton"),C=document.querySelector("#pictureModal"),g=document.querySelector("#deleteCardModal"),S={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__save",inactiveButtonClass:"form__save_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"},y=Array.from(document.querySelectorAll(S.formSelector));let L=null;const b=new class{constructor(e){let{nameSelector:t,descriptionSelector:s,avatarSelector:n}=e;this._nameContainer=document.querySelector(t),this._descriptionContainer=document.querySelector(s),this._avatarContainer=document.querySelector(n)}getUserInfo(){return{name:this._nameContainer.textContent,about:this._descriptionContainer.textContent,avatar:this._avatarContainer.src}}setUserInfo(e){let{name:t,about:s,avatar:n}=e;this._nameContainer.textContent=t,this._descriptionContainer.textContent=s,this._avatarContainer.src=n}}({nameSelector:".profile__info-name",descriptionSelector:".profile__info-description",avatarSelector:".profile__image-avatar"}),k=new class{constructor(e){this.options=e,this.baseUrl=this.options.baseUrl,this.headers=this.options.headers}_handleResponse(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}getInitialCards(){return fetch("".concat(this.baseUrl,"/cards"),{headers:this.headers}).then((e=>this._handleResponse(e)))}getUserData(){return fetch("".concat(this.baseUrl,"/users/me"),{headers:this.headers}).then((e=>this._handleResponse(e)))}updateUserInfo(e){return fetch("".concat(this.baseUrl,"/users/me"),{method:"PATCH",headers:this.headers,body:JSON.stringify(e)}).then((e=>this._handleResponse(e)))}updateProfilePicture(e){return fetch("".concat(this.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this.headers,body:JSON.stringify(e)}).then((e=>this._handleResponse(e)))}addNewCard(e){return fetch("".concat(this.baseUrl,"/cards"),{method:"POST",headers:this.headers,body:JSON.stringify({name:e.name,link:e.link})}).then((e=>this._handleResponse(e)))}deleteCard(e){return fetch("".concat(this.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this.headers}).then((e=>this._handleResponse(e)))}likeCard(e){return fetch("".concat(this.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this.headers}).then((e=>this._handleResponse(e)))}unlikeCard(e){return fetch("".concat(this.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this.headers}).then((e=>this._handleResponse(e)))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"dfa974a3-627e-4477-8e0f-f2d5983e285f","Content-Type":"application/json"}});let q;Promise.all([k.getUserData(),k.getInitialCards()]).then((e=>{let[t,s]=e;b.setUserInfo(t),L=t._id,q=new o({data:s,renderer:x},".elements__grid"),q.renderItems()})).catch((e=>{console.log(e)}));const x=t=>{const s=new e(t,"#card-template",A,R,w,L).generateCard();q.addItem(s)},I=new r(d,(function(){const e={name:l.value,link:c.value};I.setLoadingText(!0),k.addNewCard(e).then((e=>{x(e)})).catch((e=>{console.log(e)})).finally((()=>{I.setLoadingText(!1),I.closePopup()}))}));I.setEventListeners();const P=new r(_,(function(){const e={name:i.value,about:a.value};P.setLoadingText(!0),k.updateUserInfo(e).then((e=>{b.setUserInfo(e)})).catch((e=>{console.log(e)})).finally((()=>{P.setLoadingText(!1),P.closePopup()}))}));P.setEventListeners();const T=new r(m,(function(){const e={avatar:E.value};T.setLoadingText(!0),k.updateProfilePicture(e).then((e=>{f.src=e.avatar})).catch((e=>{console.log(e)})).finally((()=>{T.setLoadingText(!1),T.closePopup()}))}));T.setEventListeners();const B=new class extends n{constructor(e,t){super(e),this._handleFormSubmit=t,this._formElement=this._popupElement.querySelector(".form"),this._buttonTextContainer=this._formElement.querySelector(".form__save"),this._defaultButtonText=this._buttonTextContainer.textContent}setLoadingText(e){this._buttonTextContainer.textContent=e?"Saving...":this._defaultButtonText}openPopup(e){this._card=e,super.openPopup()}setEventListeners(){super.setEventListeners(),this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._card)}))}}(g,(function(e){k.deleteCard(e.getId()).then((()=>{e.deleteCard()})).catch((e=>{console.log(e)})),B.closePopup()}));B.setEventListeners();const U=new class extends n{constructor(e){super(e),this._popupImage=this._popupElement.querySelector(".modal__picture-image"),this._popupText=this._popupElement.querySelector(".modal__picture-text")}openPopup(e){this._popupImage.src=e.link,this._popupImage.alt=e.name,this._popupText.textContent=e.name,super.openPopup()}}(C);function w(e){e.isLikedByUser()?k.unlikeCard(e.getId()).then((t=>e.setLikes(t.likes))).catch((e=>console.log(e))):k.likeCard(e.getId()).then((t=>e.setLikes(t.likes))).catch((e=>console.log(e)))}function A(e){U.openPopup(e)}function R(e){B.openPopup(e)}U.setEventListeners(),u.addEventListener("click",(function(){const e=b.getUserInfo();i.value=e.name,a.value=e.about,P.openPopup()})),h.addEventListener("click",(function(){I.openPopup()})),v.addEventListener("click",(function(){T.openPopup()})),y.forEach((e=>{!function(e,s){new t(e,s).enableValidation()}(S,e)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVFDLElBQUlGLElBT2pDLENBRUQsU0FBU2pMLEVBQWdCc0ssR0FDdkJ5QixFQUFXMUcsVUFBVWlGLEVBQ3RCLENBRUQsU0FBU3JLLEVBQWlCcUssR0FDeEJ1QixFQUFXeEcsVUFBVWlGLEVBQ3RCLENBckJEeUIsRUFBV3RHLG9CQW9IWDhCLEVBQVdoRixpQkFBaUIsU0F2RjVCLFdBQ0UsTUFBTTJKLEVBQVUvRCxFQUFLTyxjQUNyQnhCLEVBQVViLE1BQVE2RixFQUFRN0wsS0FDMUI4RyxFQUFpQmQsTUFBUTZGLEVBQVF2RCxNQUNqQzhDLEVBQVNwRyxXQUNWLElBbUZEbUMsRUFBVWpGLGlCQUFpQixTQWpGM0IsV0FDRStJLEVBQVFqRyxXQUNULElBZ0ZEeUMsRUFBYXZGLGlCQUFpQixTQTlFOUIsV0FDRW9KLEVBQVd0RyxXQUNaLElBK0VENkMsRUFBU3hFLFNBQVNiLEtBakdsQixTQUF1QkQsRUFBVUMsR0FDTCxJQUFJRixFQUFjQyxFQUFVQyxHQUNwQ1Usa0JBQ25CLENBK0ZDNEksQ0FBY3ZKLEVBQVVDLEVBQXhCLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgICBjb25zdHJ1Y3RvcihkYXRhLCB0ZW1wbGF0ZVNlbGVjdG9yLCBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZUNhcmREZWxldGUsIGhhbmRsZUNhcmRMaWtlLCBjdXJyZW50VXNlcklkKSB7XHJcbiAgICAgIHRoaXMubmFtZSA9IGRhdGEubmFtZTtcclxuICAgICAgdGhpcy5saW5rID0gZGF0YS5saW5rO1xyXG4gICAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XHJcbiAgICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XHJcbiAgICAgIHRoaXMuX293bmVyID0gZGF0YS5vd25lcjtcclxuICAgICAgdGhpcy5fY3VycmVudFVzZXJJZCA9IGN1cnJlbnRVc2VySWQ7XHJcbiAgICAgIHRoaXMudGVtcGxhdGVTZWxlY3RvciA9IHRlbXBsYXRlU2VsZWN0b3I7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZExpa2UgPSBoYW5kbGVDYXJkTGlrZTtcclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZERlbGV0ZSA9IGhhbmRsZUNhcmREZWxldGU7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBnZXRJZCgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2lkO1xyXG4gICAgfVxyXG5cclxuICAgIF9zZXRNYXJrdXAoKSB7XHJcbiAgICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLmxpbms7XHJcbiAgICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLm5hbWU7XHJcbiAgICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fYm90dG9tLXRleHRcIikudGV4dENvbnRlbnQgPVxyXG4gICAgICAgIHRoaXMubmFtZTtcclxuICAgIH1cclxuICBcclxuICAgIF9yZW5kZXJMaWtlcygpIHtcclxuICAgICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19ib3R0b20tY291bnRcIikudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcbiAgICAgIHRoaXMubGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fYm90dG9tLWJ1dHRvblwiKTtcclxuICAgICAgaWYgKHRoaXMuaXNMaWtlZEJ5VXNlcigpKSB7XHJcbiAgICAgICAgdGhpcy5saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19ib3R0b20tYnV0dG9uX2NsaWNrZWRcIik7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19ib3R0b20tYnV0dG9uX2NsaWNrZWRcIik7XHJcbiAgICAgIH1cclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBzZXRMaWtlcyhsaWtlcykge1xyXG4gICAgICB0aGlzLl9saWtlcyA9IGxpa2VzO1xyXG4gICAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xyXG4gICAgfVxyXG5cclxuICAgIF9nZXRUZW1wbGF0ZUNsb25lKCkge1xyXG4gICAgICBjb25zdCBjbG9uZUVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMudGVtcGxhdGVTZWxlY3RvcilcclxuICAgICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICByZXR1cm4gY2xvbmVFbGVtZW50O1xyXG4gICAgfVxyXG4gIFxyXG4gICAgaXNMaWtlZEJ5VXNlcigpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2xpa2VzLnNvbWUoKGxpa2UpID0+IGxpa2UuX2lkID09PSB0aGlzLl9jdXJyZW50VXNlcklkKTtcclxuICAgIH1cclxuICBcclxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19ib3R0b20tYnV0dG9uXCIpXHJcbiAgICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZSh0aGlzKTtcclxuICAgICAgICB9KTtcclxuICBcclxuICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uXHJcbiAgICAgICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlQ2FyZERlbGV0ZSh0aGlzKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICBcclxuXHJcbiAgICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIilcclxuICAgICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBkZWxldGVDYXJkKCkge1xyXG4gICAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICAgICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlQ2xvbmUoKTtcclxuICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGVcIik7XHJcbiAgICAgIGlmICh0aGlzLl9jdXJyZW50VXNlcklkICE9PSB0aGlzLl9vd25lci5faWQpIHtcclxuICAgICAgICB0aGlzLl9kZWxldGVCdXR0b24ucmVtb3ZlKCk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5fc2V0TWFya3VwKCk7XHJcbiAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XHJcbiAgICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICAgIH1cclxuICB9XHJcbiAgIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgICAgdGhpcy5fc2V0dGluZ3MgPSBzZXR0aW5ncztcclxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3NldHRpbmdzLmlucHV0U2VsZWN0b3IpXHJcbiAgICAgICk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICAgIHRoaXMuX3NldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwicmVzZXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX3Jlc2V0VmFsaWRhdGlvbigpO1xyXG4gICAgICB9KTtcclxuICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5fdG9nZ2xlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUodGhpcy5faW5wdXRMaXN0LCB0aGlzLl9idXR0b25FbGVtZW50KTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBfdG9nZ2xlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIFxyXG4gICAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XHJcbiAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICAgICk7XHJcbiAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICAgICk7XHJcbiAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmVycm9yQ2xhc3MpO1xyXG4gICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgX2VuYWJsZUJ1dHRvbigpIHtcclxuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfVxyXG5cclxuICAgIF9kaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIH1cclxuICBcclxuICAgIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dExpc3QpKSB7XHJcbiAgICAgICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgXHJcbiAgICBfcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBFbGVtZW50KSB7XHJcbiAgICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IHBvcHVwRWxlbWVudDtcclxuICAgICAgdGhpcy5fcG9wdXBFeGl0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICAgXCIubW9kYWxfX2NvbnRhaW5lci1leGl0XCJcclxuICAgICAgKTtcclxuICAgIH1cclxuICBcclxuICAgIG9wZW5Qb3B1cCgpIHtcclxuICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlQ2xpY2tDbG9zZSk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBjbG9zZVBvcHVwKCkge1xyXG4gICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgICB0aGlzLl9wb3B1cEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9oYW5kbGVDbGlja0Nsb3NlKTtcclxuICAgIH1cclxuICBcclxuICAgIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcclxuICAgICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgICB0aGlzLmNsb3NlUG9wdXAoKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICBcclxuICAgIF9oYW5kbGVDbGlja0Nsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoZXZ0LnRhcmdldCA9PT0gZXZ0LmN1cnJlbnRUYXJnZXQpIHtcclxuICAgICAgICB0aGlzLmNsb3NlUG9wdXAoKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICBcclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICB0aGlzLl9wb3B1cEV4aXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgICB0aGlzLmNsb3NlUG9wdXAoKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cEVsZW1lbnQsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHBvcHVwRWxlbWVudCk7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybV9faW5wdXRcIik7XHJcbiAgICB0aGlzLl9idXR0b25UZXh0Q29udGFpbmVyID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtX19zYXZlXCIpO1xyXG4gICAgdGhpcy5fZGVmYXVsdEJ1dHRvblRleHQgPSB0aGlzLl9idXR0b25UZXh0Q29udGFpbmVyLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgc2V0TG9hZGluZ1RleHQoaXNMb2FkaW5nKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uVGV4dENvbnRhaW5lci50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7IFxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLl9idXR0b25UZXh0Q29udGFpbmVyLnRleHRDb250ZW50ID0gdGhpcy5fZGVmYXVsdEJ1dHRvblRleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGZvcm1WYWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4gKGZvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZSkpO1xyXG5cclxuICAgIHJldHVybiBmb3JtVmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2VQb3B1cCgpIHtcclxuICAgIHN1cGVyLmNsb3NlUG9wdXAoKTtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LnJlc2V0KCk7XHJcbiAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7IGRhdGEsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICAgIHRoaXMuX2l0ZW1zID0gZGF0YTtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgICB9XHJcbiAgXHJcbiAgICByZW5kZXJJdGVtcygpIHtcclxuICAgICAgdGhpcy5faXRlbXMuZm9yRWFjaCh0aGlzLl9yZW5kZXJlcik7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfSIsImNvbnN0IGNhcmRUZW1wbGF0ZSA9IFwiI2NhcmQtdGVtcGxhdGVcIjtcclxuY29uc3QgZWxlbWVudHNHcmlkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c19fZ3JpZFwiKTtcclxuY29uc3QgZ3JpZFNlbGVjdG9yID0gXCIuZWxlbWVudHNfX2dyaWRcIjtcclxuY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNuYW1lLWlucHV0XCIpO1xyXG5jb25zdCBkZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZXNjcmlwdGlvbi1pbnB1dFwiKTtcclxuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2luZm8tbmFtZVwiKS50ZXh0Q29udGVudDtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbmZvLWRlc2NyaXB0aW9uXCIpLnRleHRDb250ZW50O1xyXG5jb25zdCB0aXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN0aXRsZS1pbnB1dFwiKTtcclxuY29uc3QgbGlua0lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNsaW5rLWlucHV0XCIpO1xyXG5jb25zdCBhZGRDYXJkV2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGRDYXJkXCIpO1xyXG5jb25zdCBlZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0XCIpO1xyXG5jb25zdCBhZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZFwiKTtcclxuY29uc3QgZWRpdFdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdFwiKTtcclxuY29uc3QgZWRpdEZvcm1FbGVtZW50ID0gZWRpdFdpbmRvdy5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbmNvbnN0IGFkZEZvcm1FbGVtZW50ID0gYWRkQ2FyZFdpbmRvdy5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbmNvbnN0IGV4aXRCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9fY29udGFpbmVyLWV4aXRcIik7XHJcbmNvbnN0IHNhdmVCdXR0b25BZGQgPSBhZGRGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiYnV0dG9uXCIpO1xyXG5jb25zdCBhdmF0YXJXaW5kb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXRBdmF0YXJcIik7XHJcbmNvbnN0IGF2YXRhcklucHV0ID0gYXZhdGFyV2luZG93LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLWxpbmstaW5wdXRcIik7XHJcbmNvbnN0IGF2YXRhclBpY3R1cmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlLWF2YXRhclwiKTtcclxuY29uc3QgYXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0QXZhdGFyQnV0dG9uXCIpO1xyXG5jb25zdCBwaWN0dXJlV2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwaWN0dXJlTW9kYWxcIik7XHJcbmNvbnN0IGRlbGV0ZVdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlQ2FyZE1vZGFsXCIpO1xyXG5jb25zdCB1c2VyU2VsZWN0b3IgPSB7bmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX19pbmZvLW5hbWVcIiwgZGVzY3JpcHRpb25TZWxlY3RvcjogXCIucHJvZmlsZV9faW5mby1kZXNjcmlwdGlvblwiLCBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9faW1hZ2UtYXZhdGFyXCJ9O1xyXG5cclxuY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgICBmb3JtU2VsZWN0b3I6IFwiLmZvcm1cIiwgXHJcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLCBcclxuICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19zYXZlXCIsIFxyXG4gICAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJmb3JtX19zYXZlX2Rpc2FibGVkXCIsIFxyXG4gICAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIiwgXHJcbiAgICBlcnJvckNsYXNzOiBcImZvcm1fX2lucHV0LWVycm9yX2FjdGl2ZVwiXHJcbn1cclxuY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuZm9ybVNlbGVjdG9yKSk7XHJcblxyXG5leHBvcnQge2NhcmRUZW1wbGF0ZSwgXHJcbiAgICBlbGVtZW50c0dyaWQsXHJcbiAgICBncmlkU2VsZWN0b3IsIFxyXG4gICAgbmFtZUlucHV0LCBcclxuICAgIGRlc2NyaXB0aW9uSW5wdXQsIFxyXG4gICAgcHJvZmlsZU5hbWUsIFxyXG4gICAgcHJvZmlsZURlc2NyaXB0aW9uLCBcclxuICAgIHRpdGxlSW5wdXQsIFxyXG4gICAgbGlua0lucHV0LCBcclxuICAgIGFkZENhcmRXaW5kb3csIFxyXG4gICAgZWRpdEJ1dHRvbiwgXHJcbiAgICBhZGRCdXR0b24sIFxyXG4gICAgZWRpdFdpbmRvdywgXHJcbiAgICBlZGl0Rm9ybUVsZW1lbnQsIFxyXG4gICAgYWRkRm9ybUVsZW1lbnQsIFxyXG4gICAgZXhpdEJ1dHRvbnMsIFxyXG4gICAgc2F2ZUJ1dHRvbkFkZCxcclxuICAgIGF2YXRhcldpbmRvdyxcclxuICAgIGF2YXRhcklucHV0LFxyXG4gICAgYXZhdGFyUGljdHVyZSxcclxuICAgIGF2YXRhckJ1dHRvbixcclxuICAgIHBpY3R1cmVXaW5kb3csXHJcbiAgICBkZWxldGVXaW5kb3csXHJcbiAgICB1c2VyU2VsZWN0b3IsICAgXHJcbiAgICBzZXR0aW5ncywgXHJcbiAgICBmb3JtTGlzdCwgXHJcbn07IiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm0uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuaW1wb3J0IHtcclxuICBjYXJkVGVtcGxhdGUsXHJcbiAgZ3JpZFNlbGVjdG9yLFxyXG4gIG5hbWVJbnB1dCxcclxuICBkZXNjcmlwdGlvbklucHV0LFxyXG4gIHRpdGxlSW5wdXQsXHJcbiAgbGlua0lucHV0LFxyXG4gIGFkZENhcmRXaW5kb3csXHJcbiAgZWRpdEJ1dHRvbixcclxuICBhZGRCdXR0b24sXHJcbiAgZWRpdFdpbmRvdyxcclxuICBwaWN0dXJlV2luZG93LFxyXG4gIHVzZXJTZWxlY3RvcixcclxuICBzZXR0aW5ncyxcclxuICBmb3JtTGlzdCxcclxuICBhdmF0YXJJbnB1dCxcclxuICBhdmF0YXJQaWN0dXJlLFxyXG4gIGF2YXRhcldpbmRvdyxcclxuICBhdmF0YXJCdXR0b24sICBcclxuICBkZWxldGVXaW5kb3dcclxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcblxyXG5sZXQgY3VycmVudFVzZXJJZCA9IG51bGw7XHJcblxyXG5jb25zdCB1c2VyID0gbmV3IFVzZXJJbmZvKHVzZXJTZWxlY3Rvcik7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpICh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJkZmE5NzRhMy02MjdlLTQ0NzctOGUwZi1mMmQ1OTgzZTI4NWZcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgfVxyXG59KTtcclxuXHJcbmxldCBjYXJkU2VjdGlvbjtcclxuXHJcblByb21pc2UuYWxsKFthcGkuZ2V0VXNlckRhdGEoKSwgYXBpLmdldEluaXRpYWxDYXJkcygpXSlcclxuICAudGhlbigoW3VzZXJJbmZvUmVzLCBjYXJkUmVzXSkgPT4ge1xyXG4gICAgdXNlci5zZXRVc2VySW5mbyh1c2VySW5mb1Jlcyk7XHJcbiAgICBjdXJyZW50VXNlcklkID0gdXNlckluZm9SZXMuX2lkO1xyXG5cclxuICAgIGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAgICAgIHtcclxuICAgICAgICBkYXRhOiBjYXJkUmVzLFxyXG4gICAgICAgIHJlbmRlcmVyOiByZW5kZXJDYXJkLFxyXG4gICAgICB9LFxyXG4gICAgICBncmlkU2VsZWN0b3JcclxuICAgICk7XHJcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgfSk7XHJcblxyXG5jb25zdCByZW5kZXJDYXJkID0gKGNhcmRJdGVtKSA9PiB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKGNhcmRJdGVtLCBjYXJkVGVtcGxhdGUsIGhhbmRsZUNhcmRDbGljaywgaGFuZGxlQ2FyZERlbGV0ZSwgaGFuZGxlQ2FyZExpa2UsIGN1cnJlbnRVc2VySWQpO1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxuXHJcbiAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XHJcbn07XHJcblxyXG5jb25zdCBhZGRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oYWRkQ2FyZFdpbmRvdywgaGFuZGxlQWRkRm9ybVN1Ym1pdCk7XHJcbmFkZEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGVkaXRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oZWRpdFdpbmRvdywgaGFuZGxlRWRpdEZvcm1TdWJtaXQpO1xyXG5lZGl0Rm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgYXZhdGFyRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKGF2YXRhcldpbmRvdywgaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdCk7XHJcbmF2YXRhckZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGRlbGV0ZUZvcm0gPSBuZXcgUG9wdXBXaXRoQ29uZmlybShkZWxldGVXaW5kb3csIGhhbmRsZURlbGV0ZUZvcm1TdWJtaXQpO1xyXG5kZWxldGVGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKHBpY3R1cmVXaW5kb3cpO1xyXG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVDYXJkTGlrZShjYXJkKSB7XHJcbiAgaWYoIWNhcmQuaXNMaWtlZEJ5VXNlcigpKSB7XHJcbiAgICBhcGkubGlrZUNhcmQoY2FyZC5nZXRJZCgpKVxyXG4gICAgICAudGhlbigoZGF0YSkgPT4gY2FyZC5zZXRMaWtlcyhkYXRhLmxpa2VzKSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBhcGkudW5saWtlQ2FyZChjYXJkLmdldElkKCkpXHJcbiAgICAgIC50aGVuKChkYXRhKSA9PiBjYXJkLnNldExpa2VzKGRhdGEubGlrZXMpKVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgfVxyXG5cclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQ2FyZENsaWNrKGNhcmQpIHtcclxuICBpbWFnZVBvcHVwLm9wZW5Qb3B1cChjYXJkKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQ2FyZERlbGV0ZShjYXJkKSB7XHJcbiAgZGVsZXRlRm9ybS5vcGVuUG9wdXAoY2FyZCk7XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBhZGRWYWxpZGF0aW9uKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gIGNvbnN0IHZhbGlkYXRpb25FbGVtZW50ID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KTtcclxuICB2YWxpZGF0aW9uRWxlbWVudC5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZU1vZGFsRWRpdCgpIHtcclxuICBjb25zdCBuZXdVc2VyID0gdXNlci5nZXRVc2VySW5mbygpO1xyXG4gIG5hbWVJbnB1dC52YWx1ZSA9IG5ld1VzZXIubmFtZTtcclxuICBkZXNjcmlwdGlvbklucHV0LnZhbHVlID0gbmV3VXNlci5hYm91dDtcclxuICBlZGl0Rm9ybS5vcGVuUG9wdXAoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTW9kYWxBZGQoKSB7XHJcbiAgYWRkRm9ybS5vcGVuUG9wdXAoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTW9kYWxBdmF0YXIoKSB7XHJcbiAgYXZhdGFyRm9ybS5vcGVuUG9wdXAoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRWRpdEZvcm1TdWJtaXQoKSB7XHJcbiAgY29uc3QgbmV3TmFtZSA9IG5hbWVJbnB1dC52YWx1ZTtcclxuICBjb25zdCBuZXdEZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uSW5wdXQudmFsdWU7XHJcbiAgY29uc3QgbmV3VXNlckluZm8gPSB7IG5hbWU6IG5ld05hbWUsIGFib3V0OiBuZXdEZXNjcmlwdGlvbiB9O1xyXG4gIGVkaXRGb3JtLnNldExvYWRpbmdUZXh0KHRydWUpO1xyXG4gIGFwaS51cGRhdGVVc2VySW5mbyhuZXdVc2VySW5mbylcclxuICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgIHVzZXIuc2V0VXNlckluZm8ocmVzKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGVkaXRGb3JtLnNldExvYWRpbmdUZXh0KGZhbHNlKTtcclxuICAgICAgZWRpdEZvcm0uY2xvc2VQb3B1cCgpO1xyXG4gICAgfSk7XHJcblxyXG4gIFxyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBZGRGb3JtU3VibWl0KCkge1xyXG4gIGNvbnN0IGNhcmREYXRhID0ge1xyXG4gICAgbmFtZTogdGl0bGVJbnB1dC52YWx1ZSxcclxuICAgIGxpbms6IGxpbmtJbnB1dC52YWx1ZSxcclxuICB9O1xyXG4gIGFkZEZvcm0uc2V0TG9hZGluZ1RleHQodHJ1ZSk7XHJcbiAgYXBpLmFkZE5ld0NhcmQoY2FyZERhdGEpXHJcbiAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICByZW5kZXJDYXJkKHJlcyk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBhZGRGb3JtLnNldExvYWRpbmdUZXh0KGZhbHNlKTtcclxuICAgICAgYWRkRm9ybS5jbG9zZVBvcHVwKCk7XHJcbiAgICB9KTtcclxuICBcclxuICBcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdCgpIHtcclxuICBjb25zdCBhdmF0YXJJbmZvID0ge2F2YXRhcjogYXZhdGFySW5wdXQudmFsdWV9O1xyXG4gIFxyXG4gIGF2YXRhckZvcm0uc2V0TG9hZGluZ1RleHQodHJ1ZSk7XHJcbiAgYXBpLnVwZGF0ZVByb2ZpbGVQaWN0dXJlKGF2YXRhckluZm8pXHJcbiAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICBhdmF0YXJQaWN0dXJlLnNyYyA9IHJlcy5hdmF0YXI7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBhdmF0YXJGb3JtLnNldExvYWRpbmdUZXh0KGZhbHNlKTtcclxuICAgICAgYXZhdGFyRm9ybS5jbG9zZVBvcHVwKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUZvcm1TdWJtaXQoY2FyZCkge1xyXG4gIGFwaS5kZWxldGVDYXJkKGNhcmQuZ2V0SWQoKSlcclxuICAudGhlbigoKSA9PiB7XHJcbiAgICBjYXJkLmRlbGV0ZUNhcmQoKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gIH0pXHJcblxyXG4gIGRlbGV0ZUZvcm0uY2xvc2VQb3B1cCgpO1xyXG59XHJcblxyXG5lZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVNb2RhbEVkaXQpO1xyXG5hZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZU1vZGFsQWRkKTtcclxuYXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVNb2RhbEF2YXRhcik7XHJcblxyXG5cclxuZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICBhZGRWYWxpZGF0aW9uKHNldHRpbmdzLCBmb3JtRWxlbWVudCk7XHJcbn0pO1xyXG5cclxuXHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICAgIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBkZXNjcmlwdGlvblNlbGVjdG9yLCBhdmF0YXJTZWxlY3Rvcn0pIHtcclxuICAgICAgdGhpcy5fbmFtZUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgICAgdGhpcy5fZGVzY3JpcHRpb25Db250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRlc2NyaXB0aW9uU2VsZWN0b3IpO1xyXG4gICAgICB0aGlzLl9hdmF0YXJDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcclxuICAgIH1cclxuICBcclxuICAgIGdldFVzZXJJbmZvKCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIG5hbWU6IHRoaXMuX25hbWVDb250YWluZXIudGV4dENvbnRlbnQsXHJcbiAgICAgICAgYWJvdXQ6IHRoaXMuX2Rlc2NyaXB0aW9uQ29udGFpbmVyLnRleHRDb250ZW50LFxyXG4gICAgICAgIGF2YXRhcjogdGhpcy5fYXZhdGFyQ29udGFpbmVyLnNyY1xyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gIFxyXG4gICAgc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCwgYXZhdGFyfSkge1xyXG4gICAgICB0aGlzLl9uYW1lQ29udGFpbmVyLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgICAgdGhpcy5fZGVzY3JpcHRpb25Db250YWluZXIudGV4dENvbnRlbnQgPSBhYm91dDtcclxuICAgICAgdGhpcy5fYXZhdGFyQ29udGFpbmVyLnNyYyA9IGF2YXRhcjtcclxuICAgIH1cclxuICB9IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xyXG4gICAgICAgIHRoaXMuYmFzZVVybCA9IHRoaXMub3B0aW9ucy5iYXNlVXJsO1xyXG4gICAgICAgIHRoaXMuaGVhZGVycyA9IHRoaXMub3B0aW9ucy5oZWFkZXJzO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVSZXNwb25zZShyZXMpIHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzYCwge2hlYWRlcnM6IHRoaXMuaGVhZGVyc30pXHJcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMpKTtcclxuICAgIH0gXHJcblxyXG4gICAgZ2V0VXNlckRhdGEoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7aGVhZGVyczogdGhpcy5oZWFkZXJzfSlcclxuICAgICAgICAudGhlbihyZXMgPT4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzKSk7XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlVXNlckluZm8odXNlck9iaikge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChcclxuICAgICAgICAgICAgYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLCBcclxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycywgXHJcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh1c2VyT2JqKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKVxyXG4gICAgICAgIC50aGVuKHJlcyA9PiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMpKTtcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVQcm9maWxlUGljdHVyZShpbmZvKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKFxyXG4gICAgICAgICAgICBgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLCBcclxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycywgXHJcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShpbmZvKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKVxyXG4gICAgICAgIC50aGVuKHJlcyA9PiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMpKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgYWRkTmV3Q2FyZChjYXJkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKFxyXG4gICAgICAgICAgICBgJHt0aGlzLmJhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIiwgXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogY2FyZC5uYW1lLCBcclxuICAgICAgICAgICAgICAgICAgICBsaW5rOiBjYXJkLmxpbmtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApXHJcbiAgICAgICAgLnRoZW4ocmVzID0+IHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlcykpO1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKFxyXG4gICAgICAgICAgICBgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIiwgXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnNcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIClcclxuICAgICAgICAudGhlbihyZXMgPT4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzKSk7XHJcbiAgICB9XHJcblxyXG4gICAgbGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKFxyXG4gICAgICAgICAgICBgJHt0aGlzLmJhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQVVRcIiwgXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnNcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIClcclxuICAgICAgICAudGhlbihyZXMgPT4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzKSk7XHJcbiAgICB9XHJcblxyXG4gICAgdW5saWtlQ2FyZChjYXJkSWQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goXHJcbiAgICAgICAgICAgIGAke3RoaXMuYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLCBcclxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVyc1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKVxyXG4gICAgICAgIC50aGVuKHJlcyA9PiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXMpKTtcclxuICAgIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwRWxlbWVudCwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwRWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvblRleHRDb250YWluZXIgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX3NhdmVcIik7XHJcbiAgICAgICAgdGhpcy5fZGVmYXVsdEJ1dHRvblRleHQgPSB0aGlzLl9idXR0b25UZXh0Q29udGFpbmVyLnRleHRDb250ZW50O1xyXG4gICAgfVxyXG5cclxuICAgIHNldExvYWRpbmdUZXh0KGlzTG9hZGluZykge1xyXG4gICAgICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgICAgICAgdGhpcy5fYnV0dG9uVGV4dENvbnRhaW5lci50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7IFxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvblRleHRDb250YWluZXIudGV4dENvbnRlbnQgPSB0aGlzLl9kZWZhdWx0QnV0dG9uVGV4dDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb3BlblBvcHVwKGNhcmQpIHtcclxuICAgICAgICB0aGlzLl9jYXJkID0gY2FyZDtcclxuICAgICAgICBzdXBlci5vcGVuUG9wdXAoKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fY2FyZCk7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBFbGVtZW50KSB7XHJcbiAgICBzdXBlcihwb3B1cEVsZW1lbnQpO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5tb2RhbF9fcGljdHVyZS1pbWFnZVwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5fcG9wdXBUZXh0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3BpY3R1cmUtdGV4dFwiKTtcclxuICB9XHJcblxyXG4gIG9wZW5Qb3B1cChjYXJkKSB7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLnNyYyA9IGNhcmQubGluaztcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2UuYWx0ID0gY2FyZC5uYW1lO1xyXG4gICAgdGhpcy5fcG9wdXBUZXh0LnRleHRDb250ZW50ID0gY2FyZC5uYW1lO1xyXG4gICAgc3VwZXIub3BlblBvcHVwKCk7XHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJ0ZW1wbGF0ZVNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlQ2FyZERlbGV0ZSIsImhhbmRsZUNhcmRMaWtlIiwiY3VycmVudFVzZXJJZCIsInRoaXMiLCJuYW1lIiwibGluayIsIl9saWtlcyIsImxpa2VzIiwiX2lkIiwiX293bmVyIiwib3duZXIiLCJfY3VycmVudFVzZXJJZCIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlQ2FyZExpa2UiLCJfaGFuZGxlQ2FyZERlbGV0ZSIsImdldElkIiwiX3NldE1hcmt1cCIsIl9jYXJkSW1hZ2UiLCJfY2FyZEVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJfcmVuZGVyTGlrZXMiLCJsZW5ndGgiLCJsaWtlQnV0dG9uIiwiaXNMaWtlZEJ5VXNlciIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsInNldExpa2VzIiwiX2dldFRlbXBsYXRlQ2xvbmUiLCJkb2N1bWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJzb21lIiwibGlrZSIsIl9zZXRFdmVudExpc3RlbmVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJfZGVsZXRlQnV0dG9uIiwiZGVsZXRlQ2FyZCIsImdlbmVyYXRlQ2FyZCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX3NldHRpbmdzIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiX2J1dHRvbkVsZW1lbnQiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImVuYWJsZVZhbGlkYXRpb24iLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJfcmVzZXRWYWxpZGF0aW9uIiwiZm9yRWFjaCIsImlucHV0RWxlbWVudCIsIl90b2dnbGVJbnB1dEVycm9yIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9lbmFibGVCdXR0b24iLCJkaXNhYmxlZCIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfZGlzYWJsZUJ1dHRvbiIsIlBvcHVwIiwicG9wdXBFbGVtZW50IiwiZXZ0Iiwia2V5IiwiY2xvc2VQb3B1cCIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJfcG9wdXBFbGVtZW50IiwiX3BvcHVwRXhpdCIsIm9wZW5Qb3B1cCIsIl9oYW5kbGVFc2NDbG9zZSIsIl9oYW5kbGVDbGlja0Nsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2J1dHRvblRleHRDb250YWluZXIiLCJfZGVmYXVsdEJ1dHRvblRleHQiLCJzZXRMb2FkaW5nVGV4dCIsImlzTG9hZGluZyIsIl9nZXRJbnB1dFZhbHVlcyIsImZvcm1WYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJyZXNldCIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwibmFtZUlucHV0IiwiZGVzY3JpcHRpb25JbnB1dCIsInRpdGxlSW5wdXQiLCJsaW5rSW5wdXQiLCJhZGRDYXJkV2luZG93IiwiZWRpdEJ1dHRvbiIsImFkZEJ1dHRvbiIsImVkaXRXaW5kb3ciLCJhZGRGb3JtRWxlbWVudCIsImF2YXRhcldpbmRvdyIsImF2YXRhcklucHV0IiwiYXZhdGFyUGljdHVyZSIsImF2YXRhckJ1dHRvbiIsInBpY3R1cmVXaW5kb3ciLCJkZWxldGVXaW5kb3ciLCJmb3JtU2VsZWN0b3IiLCJmb3JtTGlzdCIsInVzZXIiLCJuYW1lU2VsZWN0b3IiLCJkZXNjcmlwdGlvblNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfbmFtZUNvbnRhaW5lciIsIl9kZXNjcmlwdGlvbkNvbnRhaW5lciIsIl9hdmF0YXJDb250YWluZXIiLCJnZXRVc2VySW5mbyIsImFib3V0IiwiYXZhdGFyIiwic2V0VXNlckluZm8iLCJhcGkiLCJvcHRpb25zIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfaGFuZGxlUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwiZ2V0VXNlckRhdGEiLCJ1cGRhdGVVc2VySW5mbyIsInVzZXJPYmoiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInVwZGF0ZVByb2ZpbGVQaWN0dXJlIiwiaW5mbyIsImFkZE5ld0NhcmQiLCJjYXJkIiwiY2FyZElkIiwibGlrZUNhcmQiLCJ1bmxpa2VDYXJkIiwiYXV0aG9yaXphdGlvbiIsImNhcmRTZWN0aW9uIiwiYWxsIiwidXNlckluZm9SZXMiLCJjYXJkUmVzIiwicmVuZGVyQ2FyZCIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImNhcmRJdGVtIiwiY2FyZEVsZW1lbnQiLCJhZGRGb3JtIiwiY2FyZERhdGEiLCJmaW5hbGx5IiwiZWRpdEZvcm0iLCJuZXdVc2VySW5mbyIsImF2YXRhckZvcm0iLCJhdmF0YXJJbmZvIiwiZGVsZXRlRm9ybSIsIl9jYXJkIiwiaW1hZ2VQb3B1cCIsIl9wb3B1cEltYWdlIiwiX3BvcHVwVGV4dCIsIm5ld1VzZXIiLCJhZGRWYWxpZGF0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==